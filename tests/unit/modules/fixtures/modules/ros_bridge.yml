module: ros_bridge
fixtures:
  interface_bridge_export: |
    # sep/06/2020 03:08:16 by RouterOS 6.47.2
    # software id =
    /interface bridge
    add comment="trunk bridge" name=br-trunk arp=reply-only
    add comment="wan bridge" name=br-wan arp=reply-only
    
tests:
  -
    commands:
      - '/interface bridge set [ find name=br-wan ] comment="updated comment" arp=enabled'
      - '/interface bridge set [ find name=br-trunk ] comment="updated comment" arp=enabled vlan-filtering=yes'
    argument_spec:
      config:
        -
          name: br-wan
          comment: 'updated comment'
          arp: enabled
        -
          name: br-trunk
          comment: 'updated comment'
          arp: enabled
          vlan_filtering: 'yes'
      state: merged
  -
    commands:
      - '/interface bridge set [ find name=br-wan ] comment="replaced comment" arp=enabled'
      - '/interface bridge set [ find name=br-trunk ] comment="replaced comment" arp=enabled'
    argument_spec:
      config:
        -
          name: br-wan
          comment: 'replaced comment'
        -
          name: br-trunk
          comment: 'replaced comment'
      state: replaced
  -
    commands:
      - '/interface bridge remove [ find name=br-trunk ]'
      - '/interface bridge remove [ find name=br-wan ]'
      - '/interface bridge add comment="new bridge" name=br-new'
      - '/system script run ansible-remove-invalid'
    argument_spec:
      config:
        -
          comment: 'new bridge'
          name: br-new
      state: overridden
  -
    commands:
      - '/interface bridge remove [ find name=br-trunk ]'
      - '/interface bridge remove [ find name=br-wan ]'
      - '/system script run ansible-remove-invalid'
    argument_spec:
      config:
        -
          name: br-trunk
        -
          name: br-wan
      state: deleted
